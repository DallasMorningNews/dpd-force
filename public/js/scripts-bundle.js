$(document).ready(function(){function e(e){forceData=GeoJSON.parse(e,{Point:["latitude","longitude"],exclude:[]}),console.log(forceData),o(forceData)}function o(e){r.addSource("dpdForceData",{type:"geojson",data:e}),r.addLayer({id:"forceIncidents",source:"dpdForceData",type:"circle",layout:{visibility:"visible"},paint:{"circle-radius":{stops:[[8,2],[11,4],[15,8]]},"circle-color":"#950000"}}),r.on("click",function(o){var a=r.queryRenderedFeatures(o.point,{layers:["forceIncidents"]});if(a.length){var n=a[0],c=n.properties.id,s="";$.each(e.features,function(e,o){if(o.properties.id===c){var t=o.properties.force_use.length;for(i=0;i<t;i++)s+="<span class='badge' data-badge='"+o.properties.force_use[i].current_badge_no+"'>"+o.properties.force_use[i].current_badge_no+"</span>"}}),$(".badge").click(function(){var e=$(this).attr("data-badge");t(e)}),console.log(n);(new mapboxgl.Popup).setLngLat(n.geometry.coordinates).setHTML(s).addTo(r);$(".badge").click(function(){var e=$(this).attr("data-badge");t(e)}),r.flyTo({center:n.geometry.coordinates,zoom:Math.max(14,r.getZoom())})}}),r.on("mousemove",function(e){var o=r.queryRenderedFeatures(e.point,{layers:["forceIncidents"]});r.getCanvas().style.cursor=o.length?"pointer":""})}function t(e){r.setFilter("forceIncidents",["==",e,!0])}var a=new Date,n=a.getFullYear();$(".copyright").text(n);var r=new mapboxgl.Map({container:"map",style:"http://maps.dallasnews.com/styles.json",center:[-96.7870228,32.8255772],zoom:10});r.on("load",function(){r.scrollZoom.disable(),r.addControl(new mapboxgl.Navigation),$.getJSON("js/map_data.json",function(o){e(o),console.log(o)})}),$(".clearMap").click(function(){console.log("test"),r.setFilter("forceIncidents",[">=","id",0])})});
//# sourceMappingURL=scripts-bundle.js.map
