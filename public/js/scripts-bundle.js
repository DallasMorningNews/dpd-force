$(document).ready(function(){function e(e){s=GeoJSON.parse(e,{Point:["latitude","longitude"],exclude:[]}),o(s),console.log(s)}function o(e){d.addSource("dpdForceData",{type:"geojson",data:e}),d.addLayer({id:"forceIncidents",source:"dpdForceData",type:"circle",layout:{visibility:"visible"},paint:{"circle-radius":{stops:[[8,2],[11,4],[15,8]]},"circle-color":"#950000"}}),d.on("click",function(o){var a=d.queryRenderedFeatures(o.point,{layers:["forceIncidents"]});if(a.length){var n=a[0],r=n.properties.id,c="";$.each(e.features,function(e,o){if(o.properties.id===r){var t=o.properties.force_use.length;for(i=0;i<t;i++)c+="<span class='badge' data-badge='"+o.properties.force_use[i].current_badge_no+"'>"+o.properties.force_use[i].current_badge_no+"</span>"}});(new mapboxgl.Popup).setLngLat(n.geometry.coordinates).setHTML(c).addTo(d);$(".badge").click(function(){var e=$(this).attr("data-badge");t(e)}),d.flyTo({center:n.geometry.coordinates,zoom:Math.max(14,d.getZoom())})}}),d.on("mousemove",function(e){var o=d.queryRenderedFeatures(e.point,{layers:["forceIncidents"]});d.getCanvas().style.cursor=o.length?"pointer":""})}function t(e){a();var t=[];$.each(c,function(o,a){var n=a.force_use.length;for(i=0;i<n;i++)a.force_use[i].current_badge_no===e&&t.push(a)}),t=GeoJSON.parse(t,{Point:["latitude","longitude"],exclude:[]}),o(t)}function a(){d.off("click"),d.off("mousemove"),d.removeLayer("forceIncidents"),d.removeSource("dpdForceData")}var n=new Date,r=n.getFullYear();$(".copyright").text(r);var c,s,d=new mapboxgl.Map({container:"map",style:"http://maps.dallasnews.com/styles.json",center:[-96.7870228,32.8255772],zoom:10});d.on("load",function(){d.scrollZoom.disable(),d.addControl(new mapboxgl.Navigation),$.getJSON("js/map_data.json",function(o){c=o,e(c)})}),$(".clearMap").click(function(){console.log("test"),a(),o(s)})});
//# sourceMappingURL=scripts-bundle.js.map
